Fixes CVE-2021-3733.
Desc:
  There's a flaw in urllib's AbstractBasicAuthHandler class. An attacker who
  ontrols a malicious HTTP server that an HTTP client (such as web browser)
  connects to, could trigger a Regular Expression Denial of Service (ReDOS)
  during an authentication request with a specially crafted payload that is
  sent by the server to the client. The greatest threat that this flaw poses
  is to application availability.

Upstream bug: https://bugs.python.org/issue43075

Upstream commit (backported from Python 3.7):
https://github.com/python/cpython/commit/ada14995870abddc277addf57dd690a2af04c2da

--- Python-2.7.18/Lib/urllib2.py
+++ Python-2.7.18/Lib/urllib2.py
@@ -858,7 +858,7 @@
     # (single quotes are a violation of the RFC, but appear in the wild)
     rx = re.compile('(?:^|,)'   # start of the string or ','
                     '[ \t]*'    # optional whitespaces
-                    '([^ \t]+)' # scheme like "Basic"
+                    '([^ \t,]+)' # scheme like "Basic"
                     '[ \t]+'    # mandatory whitespaces
                     # realm=xxx
                     # realm='xxx'

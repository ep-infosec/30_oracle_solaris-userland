Fixes CVE-2020-36242.
Desc:
  In the cryptography package before 3.3.2 for Python, certain sequences of
  update calls to symmetrically encrypt multi-GB values could result in an
  integer overflow and buffer overflow, as demonstrated by the Fernet class.

Upstream PR:
https://github.com/pyca/cryptography/pull/5748

--- cryptography-3.1.1/src/cryptography/hazmat/backends/openssl/ciphers.py
+++ cryptography-3.1.1/src/cryptography/hazmat/backends/openssl/ciphers.py
@@ -17,7 +17,7 @@ from cryptography.hazmat.primitives.ciph
 class _CipherContext(object):
     _ENCRYPT = 1
     _DECRYPT = 0
-    _MAX_CHUNK_SIZE = 2 ** 31
+    _MAX_CHUNK_SIZE = 2 ** 30 - 1
 
     def __init__(self, backend, cipher, mode, operation):
         self._backend = backend

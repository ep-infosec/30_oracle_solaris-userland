#
# This patch updates a number of man pages to reflect Solaris specific features
# in Kerberos.
#
# Note: It is not intended that these changes are to be contributed to MIT given
# that the associated updates are for Solaris only features.
# Patch source: in-house
#
--- a/src/man/kadm5.acl.man
+++ b/src/man/kadm5.acl.man
@@ -137,6 +137,12 @@ T}	T{
 T}
 _
 T{
+u
+T}	T{
+[Dis]allows the creation of one-component user principals whose password can be validated with PAM
+T}
+_
+T{
 x
 T}	T{
 Short for admcilsp. All privileges (except \fBe\fP)
--- a/src/man/kadmind.man
+++ b/src/man/kadmind.man
@@ -150,4 +150,16 @@ MIT
 .SH COPYRIGHT
 1985-2022, MIT
 .\" Generated by docutils manpage writer.
+.SH NOTES
+.sp
+The \fBkadmind\fR service is managed by the service management facility, \fBsmf\fR(7), under the service identifier:
+.sp
+.in +2
+.nf
+svc:/network/security/kadmin:default
+.fi
+.in -2
+.sp
+Administrative actions on this service, such as enabling, disabling, or requesting restart, can be performed using \fBsvcadm\fR(8). The service's status can be queried using the \fBsvcs\fR(1) command.
+.sp
 .
--- a/src/man/kdc.conf.man
+++ b/src/man/kdc.conf.man
@@ -98,6 +98,8 @@ the definitions of these relations.
 .IP \(bu 2
 \fBkdc_listen\fP
 .IP \(bu 2
+\fBkdc_max_tcp_connections\fP
+.IP \(bu 2
 \fBkdc_ports\fP
 .IP \(bu 2
 \fBkdc_tcp_listen\fP
@@ -381,6 +383,11 @@ to any of the specified addresses, it will fail to start.  The
 default is to bind to the wildcard address on the standard port.
 New in release 1.15.
 .TP
+.B \fBkdc_max_tcp_connections\fP
+This relation controls the maximum number of TCP connections the
+KDC allows. The minimum value is 10. If this relation is not specified, the
+Kerberos server allows a maximum of 30 TCP connections.
+.TP
 \fBkdc_ports\fP
 (Whitespace\- or comma\-separated list, deprecated.)  Prior to
 release 1.15, this relation lists the ports for the
@@ -728,11 +735,64 @@ supported by the syslog(3) call minus the LOG_ prefix: \fBKERN\fP,
 facility is specified, the default is \fBAUTH\fP\&.
 .UNINDENT
 .sp
+The following relation can be defined to specify how to rotate \fBkadmin\fP
+and \fBkdc\fP log files if the \fBFILE:\fP value is being used to log:
+.sp
+.TP
+.B \fBadmin_server_rotate\fP
+.TP
+.B \fBkdc_rotate\fP
+A relation subsection that enables \fBkadmin\fP (\fBadmin_server_rotate\fP)
+and/or \fBkdc\fP (\fBkdc_rotate\fP) logging to be rotated to multiple files
+based on a time interval.  This can be used to avoid logging to one
+file, which might grow too large and bring the \fBKDC\fP to a halt.
+.UNINDENT
+.sp
+.INDENT 0.0
+The time interval for the rotation is specified by the \fBperiod\fP relation.
+The number of log files to be rotated is specified by the \fBversions\fP
+relation.  Both the \fBperiod\fP and \fBversions\fP (described below) should be
+included in this subsection.  And, this subsection applies only if the
+\fBkdc\fP relation has a \fBFILE:\fP value.
+.sp
+The following relations can be specified for the \fBkdc_rotate\fP relation
+subsection:
+.sp
+.TP
+.B \fBperiod\fP=\fIdelta_time\fP
+Specifies the time interval before a new log file is created.  See
+the \fBTimeFormats\fP section in \fBkinit\fP(1) for the valid time duration
+formats you can specify for \fIdelta_time\fP.  If \fBperiod\fP is not specified
+or set to never, no rotation occurs.
+.UNINDENT
+.sp
+.INDENT 0.0
+Specifying a time interval does not mean that the log files are rotated
+at the time interval based on real time.  This is because the time
+interval is checked  at each attempt to write a record to the log, or
+when logging is actually occurring.  Therefore, rotation occurs only
+when logging has actually occurred for the specified time interval.
+.sp
+.TP
+.B \fBversions\fP=\fInumber\fP
+Specifies how many previous versions are saved before the rotation
+begins.  A number is appended to the log file, starting with 0 and
+ending with (\fInumber\fP - 1). For example, if \fBversions\fP is set to 2, up
+to three logging files are created (\fIfilename\fP, \fIfilename\fP.0, and
+\fIfilename\fP.1) before the first one is overwritten to begin the rotation.
+.UNINDENT
+.sp
+.INDENT 0.0
+Notice that if \fBversions\fP is not specified or set to \fB0\fP, only one log
+file is created, but it is overwritten whenever the time interval is met.
+.sp
 In the following example, the logging messages from the KDC will go to
-the console and to the system log under the facility LOG_DAEMON, and
-the logging messages from the administrative server will be appended
-to the file \fB/var/adm/kadmin.log\fP and sent to the device
-\fB/dev/tty04\fP\&.
+the console and to the system log under the facility LOG_DAEMON with
+default severity of LOG_INFO; and the logging messages from the
+administrative server will be appended to the file
+\fB/var/adm/kadmin.log\fP and sent to the device \fB/dev/tty04\fP\&.
+\fB/var/adm/kadmin.log\fP is rotated between twenty-one log files with a
+specified time interval of a day.
 .INDENT 0.0
 .INDENT 3.5
 .sp
@@ -743,6 +803,10 @@ to the file \fB/var/adm/kadmin.log\fP and sent to the device
     kdc = SYSLOG:INFO:DAEMON
     admin_server = FILE:/var/adm/kadmin.log
     admin_server = DEVICE=/dev/tty04
+    admin_server_rotate = {
+        period = 1d
+        versions = 20
+    }
 .ft P
 .fi
 .UNINDENT
--- a/src/man/kpropd.man
+++ b/src/man/kpropd.man
@@ -168,4 +168,16 @@ MIT
 .SH COPYRIGHT
 1985-2022, MIT
 .\" Generated by docutils manpage writer.
+.SH NOTES
+.sp
+The \fBkprop\fR service is managed by the service management facility, \fBsmf\fR(7), under the service identifier:
+.sp
+.in +2
+.nf
+svc:/network/security/krb5_prop:default
+.fi
+.in -2
+.sp
+Administrative actions on this service, such as enabling, disabling, or requesting restart, can be performed using \fBsvcadm\fR(8). The service's status can be queried using the \fBsvcs\fR(1) command.
+.sp
 .
--- a/src/man/krb5.conf.man
+++ b/src/man/krb5.conf.man
@@ -183,9 +183,23 @@ If this flag is set to false, then weak encryption types (as noted
 in Encryption_types in kdc.conf(5)) will be filtered
 out of the lists \fBdefault_tgs_enctypes\fP,
 \fBdefault_tkt_enctypes\fP, and \fBpermitted_enctypes\fP\&.  The default
-value for this tag is false.
+value for this tag is false, which may cause authentication
+failures in existing Kerberos infrastructures that do not support
+strong crypto.  Users in affected environments should set this tag
+to true until their infrastructure adopts stronger ciphers.
+.TP
+.B \fBap_req_checksum_type\fP
+An integer which specifies the type of AP\-REQ checksum to use in
+authenticators.  This variable should be unset so the appropriate
+checksum for the encryption key in use will be used.  This can be
+set if backward compatibility requires a specific checksum type.
+See the \fBkdc_req_checksum_type\fP configuration option for the
+possible values and their meanings.
+.TP
+.B \fBauth_to_local_realm\fP
+For use in the default realm, non-default realms can be equated
+with the default realm for authenticated name-to-local name mapping.
 .TP
-\fBcanonicalize\fP
 If this flag is set to true, initial ticket requests to the KDC
 will request canonicalization of the client principal name, and
 answers with different client principals than the requested
@@ -485,7 +499,7 @@ attempt fails.
 \fBverify_ap_req_nofail\fP
 If this flag is true, then an attempt to verify initial
 credentials will fail if the client machine does not have a
-keytab.  The default value is false.
+keytab.  The default value is true.
 .TP
 \fBclient_aware_channel_bindings\fP
 If this flag is true, then all application protocol authentication
@@ -827,6 +841,52 @@ other realms should have \fBoption2\fP set to true.
 The list of specifiable options for each application may be found in
 that application\(aqs man pages.  The application defaults specified here
 are overridden by those specified in the \fI\%realms\fP section.
+.sp
+The following relations can be found in the \fB[appdefaults]\fP section,
+though not all relations are recognized by all kerberized applications.
+Some are specific to particular applications.
+.TP
+.B \fBautologin\fP = [\fBtrue\fP | \fBfalse\fP]
+Forces the application to attempt  automatic  login  by  presenting
+Kerberos credentials. This is valid for the following applications:
+\fBrlogin\fP, \fBrsh\fP, \fBrcp\fP, and \fBtelnet\fP.
+.TP
+.B \fBencrypt\fP = [\fBtrue\fP | \fBfalse\fP]
+Forces applications to use encryption by default (after authentication) to
+protect the privacy of the sessions. This is valid for the following
+applications: \fBrlogin\fP, \fBrsh\fP, \fBrcp\fP, and \fBtelnet\fP.
+.TP
+.B \fBforward\fP = [\fBtrue\fP | \fBfalse\fP]
+Forces applications to forward the user's credentials (after
+authentication) to the remote server. This is valid for the following
+applications: \fBrlogin\fP, \fBrsh\fP, \fBrcp\fP, and \fBtelnet\fP.
+.TP
+.B \fBforwardable\fP = [\fBtrue\fP | \fBfalse\fP]
+See the description in the \fB[libdefaults]\fP section above.  This is
+used by any application that creates a ticket granting ticket and
+also by applications that can forward tickets to a remote server.
+.TP
+.B \fBproxiable\fP = [\fBtrue\fP | \fBfalse\fP]
+See the description in the \fB[libdefaults]\fP section above. This is
+used by any application that creates a ticket granting ticket.
+.TP
+.B \fBrenewable\fP = [\fBtrue\fP | \fBfalse\fP]
+Creates a TGT that can be renewed (prior to the ticket expiration
+time). This is used by any application that creates a ticket granting ticket.
+.TP
+.B \fBnoaddresses\fP = [\fBtrue\fP | \fBfalse\fP]
+Creates tickets with no address bindings. This is to allow tickets
+to be used across a \fBNAT\fP boundary or when using multi-homed systems.
+This option is valid in the \fBkinit [appdefault]\fP section only.
+.TP
+.B \fBrcmd_protocol\fP = [ \fBrcmdv1\fP | \fBrcmdv2\fP ]
+Specifies which Kerberized "\fBrcmd\fP" protocol to use when using the
+Kerberized \fBrlogin\fP(1), \fBrsh\fP(1), or \fBrcp\fP(1) programs. The default
+is to use \fBrcmdv2\fP by default, as this is the more secure and more recent
+update of the protocol. However, when talking to older \fBMIT\fP or \fBSEAM\fP-
+based "\fBrcmd\fP" servers, it can be necessary to force the new clients
+to use the older \fBrcmdv1\fP protocol. This option is valid only for the
+following applications: \fBrlogin\fP, \fBrcp\fP, and \fBrsh\fP.
 .SS [plugins]
 .INDENT 0.0
 .INDENT 3.5
--- a/src/man/krb5kdc.man
+++ b/src/man/krb5kdc.man
@@ -137,4 +137,16 @@ MIT
 .SH COPYRIGHT
 1985-2022, MIT
 .\" Generated by docutils manpage writer.
+.SH NOTES
+.sp
+The \fBkrb5kdc\fR service is managed by the service management facility, \fBsmf\fR(7), under the service identifier:
+.sp
+.in +2
+.nf
+svc:/network/security/krb5kdc:default
+.fi
+.in -2
+.sp
+Administrative actions on this service, such as enabling, disabling, or requesting restart, can be performed using \fBsvcadm\fR(8). The service's status can be queried using the \fBsvcs\fR(1) command.
+.sp
 .
